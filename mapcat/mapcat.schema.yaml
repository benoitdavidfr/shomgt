title: schema JSON du catalogue des cartes Shom
$id: http://geoapi.fr/shomgt/cat2/mapcat.schema
modified: '2022-06-12'
description: |
  Ce schéma définit la structure du catalogue des cartes et des écarts voulus par rapport aux sources du Shom.
  Journal:
    14/6/2022: suppression de plusieurs rubriques inutiles dans cette version.
    12/6/2022: suppression dcmi-box
    6/6/2022:
      - Ajout définition du champ badGan
      - suppression des champs spatial et replacement du champ bboxDM par spatial
    9/1/2021: Ajout de la possibilité de stocker l'épaisseur du cadre pour les cartes non géo-référencées
    24/12/2020: Gestion des cartes obsolètes dans un dictionnaire à part.
$schema: http://json-schema.org/schema#
definitions:
  dateIso8601:
    description: date au format ISO 8601 limité aux cas les plus fréquents
    type: string
    pattern: '^\d\d\d\d-\d\d-\d\d(T\d\d:\d\d(:\d\d(\.\d+)?)?)?([+-]\d\d:\d\d|Z)?$'
    examples:
      - '2020-01-10'
      - '2020-01-10T16:33'
      - '2020-01-10T16:33:34.56'
      - '2020-01-10T16:33:34.56+01:00'
      - '2020-01-10T16:33:34.56Z'
      - '2020-01-10T16:33+01:00'
      - '2020-01-10+01:00'
    counterexamples:
      - '2020-01-10T16'
  scaleDenominator:
    description: dénominateur de l'échelle avec . comme séparateur des milliers
    type: string
    pattern: '^\d{1,3}(\.\d{3})*$'
    examples:
      - '5'
      - '500'
      - '1.500'
      - '23.600'
      - '123.800'
      - '1.123.600'
      - '12.123.600'
      - '123.123.600'
    counterexamples:
      - '1500'
      - '15.00'
  latLonDM:
    description: couple (latitude, longitude) en degrés minutes
    type: string
    pattern: '^\d+°(\d+(,\d+)?'')?(N|S) - \d+°(\d+(,\d+)?'')?(E|W)$'
    examples:
      - "44°09,00'N - 002°36,00'W"
      - "45°49,00'N - 001°00,00'W"
      - "30°S - 153°E"
  spatial:
    description: |
      boite englobante définie par ses 2 coins SW et NE, en degrés, minutes en WGS84
      Les longitudes doivent être comprises entre -180° et +180°.
      Les boites à cheval sur l'anti-méridien ont une longitude West supérieure à la longitude Est.
      Il existe cependant 2 exceptions pour lesquelles l'amplitude en longitude fait plus que le tour de la terre ;
      dans ce cas -180 <= west < 180 < east < 540 (360+180).
    type: object
    required: [SW, NE]
    additionalProperties: false
    properties:
      SW:
        description: latitude et longitude du coin SW en degrés minutes
        $ref: '#/definitions/latLonDM'
      NE:
        description: latitude et longitude du coin NE en degrés minutes
        $ref: '#/definitions/latLonDM'
  latitudeDd:
    description: latitude en degrés décimaux
    type: number
    minimum: -90
    maximum: 90
    examples:
      - 48.4865
      - -67.89
  longitudeDd:
    description: longitude en degrés décimaux
    type: number
    minimum: -180
    maximum: 540
    examples:
      - -1
  borders:
    description: |
      Lorsque la carte ou ses cartouches ne sont pas géoréférencés, la connaissance de l'épaisseur du cadre combinée
      à celle de la boite englobante permet de déterminer ce géoréférencement.
    type: object
    required: [left, bottom, right, top]
    additionalProperties: false
    properties:
      left:
        description: nbre de pixels du bord gauche
        $ref: '#/definitions/nbrePixels'
      bottom:
        description: nbre de pixels du bord bas
        $ref: '#/definitions/nbrePixels'
      right:
        description: nbre de pixels du bord droite
        $ref: '#/definitions/nbrePixels'
      top:
        description: nbre de pixels du bord haut
        $ref: '#/definitions/nbrePixels'
  nbrePixels:
    description: Définition d'un nbre de pixels soit comme entier positif ou nul soit comme soustraction
    oneOf:
      - type: integer
        minimum: 0
      - type: string
        pattern: '^\d+-\d+$'
  map:
    description: |
      Propriétés décrivant une carte.
      Une carte comportant un espace principal doit renseigner les champs scaleDenominator et spatial,
      Une carte ne comportant pas d'espace principal doit obligatoirement comporter au moins un cartouche.
      Lorsque l'info est différente de celle du GAN, le champ badGan doit être renseigné.
    type: object
    additionalProperties: false
    required: [title, mapsFrance]
    properties:
      groupTitle:
        description: sur-titre optionnel identifiant un ensemble de cartes
        type: string
        examples:
          - Océan Pacifique Sud
      title:
        description: titre de la carte sans son numéro
        type: string
        examples:
          - Côte Ouest de Corse - Du Cap Corse au Golfe d'Ajaccio
      scaleDenominator:
        description: |
          dénominateur de l'échelle de l'espace principal avec un . comme séparateur des milliers,
          Champ absent ssi la carte ne comporte pas d'espace principal
        $ref: '#/definitions/scaleDenominator'
      spatial:
        description: |
          boite englobante de l'espace principal de la carte en degrés et minutes en WGS84,
          ces coordonnées sont celles indiquées dans le GAN et sur la carte dans les coins SW et NE ;
          les coordonnées indiquées sur la carte sont souvent moins précises que celles du GAN.
          Champ absent ssi la carte ne comporte pas d'espace principal.
        $ref: '#/definitions/spatial'
      borders:
        description: |
          Définition de l'épaisseur du cadre de l'espace principal, permet de déterminer son géoréférencement lorsque
          le GéoTiff ne l'est pas.
        $ref: '#/definitions/borders'
      mapsFrance:
        description: |
          Liste de codes résumant l'intersection de la carte avec la ZEE française, ce qui est le cas de la plupart des cartes.
          Quelques cartes ne l'intersecte pas, ce sont des cartes petite échelle (< 1/6M) facilitant la navigation.
          Les codes des zones sont les codes ISO 3166-1 alpha-2 avec remplacement du code 'FX' par les codes 'FX-Med'
          pour la facade de Méditérannée, 'FX-Atl' pour la facade Atlantique et 'FX-MMN' pour la facade de la Manche
          et de la mer du Nord.
        type: array
        items:
          type: string
          enum: [FR, FX-Med, FX-Atl, FX-MMN, GP, GF, MQ, YT, RE, PM, BL, MF, TF, PF, WF, NC, CP]
      replaces:
        description: identification de la carte remplacée par la carte courante, optionnel
        type: string
      references:
        description: référence de la carte étrangère reproduite ssi la carte est un fac-similé
        type: string
      noteShom:
        description: commentaire associé à la carte par le Shom
        type: string
      noteCatalog:
        description: commentaire associé à la carte dans la gestion du catalogue
        type: string
      badGan:
        description: |
          commentaire indiquant que l'info de ce catalogue est différente de celle du GAN ;
          permet de lister rapidement les écarts au GAN.
        type: string
      insetMaps:
        description: liste éventuelle de cartouches
        type: array
        minItems: 1
        items:
          type: object
          additionalProperties: false
          required: [title, scaleDenominator, spatial]
          properties:
            title:
              description: titre du cartouche
              type: string
            scaleDenominator:
              description: dénominateur de l'échelle avec un . comme séparateur des milliers
              $ref: '#/definitions/scaleDenominator'
            spatial:
              description: boite englobante du cartouche en degrés, minutes en WGS84
              $ref: '#/definitions/spatial'
            borders:
              description: |
                Définition de l'épaisseur du cadre du cartouche, permet de déterminer son géoréférencement lorsque
                le GéoTiff ne l'est pas.
              $ref: '#/definitions/borders'
            noteCatalog:
              description: commentaire associé au cartouche dans la gestion du catalogue
              type: string

type: object
required: [ title, $id, $schema, modified, maps ]
additionalProperties: false
properties:
  title: { description: 'titre du document', type: string }
  description: { description: "commentaires sur le document", type: string}
  $id: { description: 'identifiant du document', type: string , format: uri }
  $schema:
    description: 'schema JSON du document'
    oneOf:
      - $ref: http://json-schema.org/schema#
      - type: string
  created: { description: 'date de création initiale du document', $ref: '#/definitions/dateIso8601' }
  modified: { description: 'date de dernière modification du document', $ref: '#/definitions/dateIso8601' }
  maps:
    description: dictionnaire des cartes non obsolètes indexées sur leur numéro précédé de 'FR'
    type: object
    additionalProperties: false
    patternProperties:
      ^FR\d\d\d\d:
        description: Description d'une carte.
        $ref: '#/definitions/map'
  obsoleteMaps:
    description: dictionnaire des cartes obsolètes indexées sur leur numéro précédé de 'FR' et la date de leur suppression
    type: object
    additionalProperties: false
    patternProperties:
      ^FR\d\d\d\d:
        description: pour chaque carte la liste des suppressions indexées par la date de suppression
        type: object
        additionalProperties: false
        patternProperties:
          ^\d\d\d\d-\d\d-\d\d:
            description: propriétés de chaque carte
            type: object
            $ref: '#/definitions/map'
  cartesAyantUnIntérêtInsuffisant:
    description: |
      Liste les cartes dont l'intérêt est insuffisant pour décrire les espaces sur lesquels la France exerce ses droits.
    type: object
    additionalProperties: false
    patternProperties:
      ^FR\d\d\d\d:
        description: description de la carte
        type: object
        additionalProperties: false
        required: [title, scaleDenominator, reason]
        properties:
          title: { description: 'titre de la carte préfixé par son numéro', type: string }
          scaleDenominator:
            description: dénominateur de l'échelle de l'espace principal avec un . comme séparateur des milliers.
            $ref: '#/definitions/scaleDenominator'
          reason: { description: motif de l'insuffisance, type: string }
  eof:
    description: propriété marquant la fin du fichier
    type: 'null'
